(function(a){a.fn.fbfriendselector=function(b){var c=a.extend({},a.fn.fbfriendselector.defaults,b);return this.each(function(){function d(){b.html(c.loadingText);var d="";FB.api("/me/friends",function(h){var i=new Array;for(var j=0,k=h.data.length;j<k;j++){i[j]=h.data[j].name+"{--}"+h.data[j].id}i.sort();var l=new Array;for(var j=0,k=i.length;j<k;j++){var m=i[j].split("{--}");i[j]=new Object;i[j].name=m[0];i[j].id=m[1];l[j]=i[j].name}var n=i.length;if(c.friendsByPage>0&&c.friendsByPage<i.length){var o=Math.ceil(i.length/c.friendsByPage);n=c.friendsByPage}var p="<ul class='fbFriends'>";for(var j=0,k=n;j<k;j++){p=p+e(i[j])}p=p+"</ul>";d=d+p;if(c.friendsByPage>0&&c.friendsByPage<i.length){var q="<nav class='pagination'><ul>";for(var j=0,k=o;j<k;j++){numPage=j+1;q=q+"<li><a href='javascript:void(0);' ";if(numPage==1){q=q+"class='current'"}q=q+" href='javascript:void(0);'>"+numPage+"</a></li>"}q=q+"</ul></nav>";d=d+q}if(c.searchEngine==true){var r="<input type='text' class='searchEngine' value='Search your friends...'>";d=r+d}b.html(d);a(".searchEngine").focus(function(){if(a(this).val()=="Search your friends..."){a(this).val("")}}).blur(function(){if(a(this).val()==""){a(this).val("Search your friends...")}});a(".searchEngine").keyup(function(c){a(".pagination").remove();a("ul.fbFriends",b).remove();if(a(this).val().length>0){var d=g(l,a(this).val());var h="<ul class='fbFriends'>";for(var j=0;j<d.length;j=j+1){h=h+e(i[d[j]])}h=h+"</ul>";b.append(h);a(".fbFriends li a",b).click(function(){t(a(this))})}else{b.append(f(n,o,i));a(".fbFriends li a",b).click(function(){t(a(this))});a(".pagination ul li a").click(function(){s(i,a(this))})}});a(".pagination ul li a").click(function(){s(i,a(this))});var s=function(d,f){a(".pagination ul li a").removeClass("current");f.addClass("current");var g=f.html();var h=c.friendsByPage*(g-1);var i="";for(var j=h,k=h+c.friendsByPage;j<k;j++){var l=d[j];if(l!==undefined){i=i+e(l)}}a("ul.fbFriends",b).html(i);a(".fbFriends li a",b).click(function(){t(a(this))})};var t=function(a){var b={id:a.data("id"),name:a.data("name")};c.onSelect(b)};a(".fbFriends li a",b).click(function(){t(a(this))});return false})}function e(a){var b="";b=b+"<li>";b=b+"<a data-id='"+a.id+"' data-name='"+a.name+"'>";b=b+"<img src='https://graph.facebook.com/"+a.id+"/picture'>";b=b+"<span>"+a.name+"</span>";b=b+"</a>";b=b+"</li>";return b}function f(a,b,d){var f="";var g="<ul class='fbFriends'>";for(var h=0,i=a;h<i;h++){g=g+e(d[h])}g=g+"</ul>";f=f+g;if(c.friendsByPage>0&&c.friendsByPage<d.length){var j="<nav class='pagination'><ul>";for(var h=0,i=b;h<i;h++){numPage=h+1;j=j+"<li><a ";if(numPage==1){j=j+"class='current'"}j=j+" href='javascript:void(0);'>"+numPage+"</a></li>"}j=j+"</ul></nav>";f=f+j}return f}function g(a,b){var c=new Array;var d=0;for(var e=0;e<a.length;e++){regEx=new RegExp(b,"gi");if(a[e].match(regEx)){c[d]=e;d=d+1}}return c}var b=a(this);FB.getLoginStatus(function(c){if(c.status==="connected"){d(c.authResponse.accessToken)}else{b.html("<a class='facebookLogin' href=''>Login with facebook</a>");a(".facebookLogin").click(function(){FB.login(function(a){if(a.authResponse){d(a.authResponse.accessToken)}});return false})}})})};a.fn.fbfriendselector.defaults={friendsByPage:0,displayThumbnail:true,loadingText:"Loading...",searchEngine:true,onSelect:function(a){var b="Id: "+a.id+"\n\nName: "+a.name;console.log(b)}}})(jQuery)